(this.webpackJsonpbooksclient=this.webpackJsonpbooksclient||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n(1),r=n.n(c),a=n(9),s=n.n(a),u=(n(16),n(2)),i=n.n(u),l=n(10),p=n(4),b=n(3);n(8);var f=function(e){var t=e.addBook,n=e.setIsLoading,r=e.bookToEdit,a=e.setBooks,s=e.setMessage,u=e.fetchWithCsrf,l=Object(c.useState)(""),f=Object(b.a)(l,2),h=f[0],j=f[1],d=Object(c.useState)(""),k=Object(b.a)(d,2),O=k[0],m=k[1],g=Object(c.useState)(0),x=Object(b.a)(g,2),v=x[0],y=x[1];function S(){return(S=Object(p.a)(i.a.mark((function e(o){var c,r,a,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),c={method:"POST",body:JSON.stringify(o)},e.prev=2,e.next=5,u("".concat("https://tb-books-backend.herokuapp.com","/books"),c);case 5:return r=e.sent,e.next=8,r.json();case 8:a=e.sent,r.ok?(console.log("async createBook: received response ".concat(JSON.stringify(a))),t(a),s("Book added successfully."),console.log("createBook: done")):(console.log("async createBook: ERROR: ".concat(r.status," - ").concat(a.error," - ").concat(a.message)),l=a.errors&&a.errors.reduce((function(e,t){return"".concat(e," ").concat(t.defaultMessage," ---")}),"--- "),s(l||a.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0),s("Connection error.");case 16:n(!1);case 17:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function w(){return(w=Object(p.a)(i.a.mark((function e(t){var n,o,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PUT",body:JSON.stringify({id:t.id,title:h,author:O,priceInEuro:v})},e.prev=1,e.next=4,u("".concat("https://tb-books-backend.herokuapp.com","/books/").concat(t.id),n);case 4:return o=e.sent,e.next=7,o.json();case 7:c=e.sent,console.log(c),o.ok?(s("Book edited successfully."),console.log("createBook: done"),a(c)):(r=c.errors&&c.errors.reduce((function(e,t){return"".concat(e," ").concat(t.defaultMessage," ---")}),"--- "),s(r||c.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),s("Connection error.");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){r&&(j(r.title),m(r.author),y(r.priceInEuro))}),[r]),Object(o.jsxs)("form",{className:"form",onSubmit:function(e){e.preventDefault()},children:["Title:",Object(o.jsx)("input",{className:"form__input",type:"text",onChange:function(e){return j(e.target.value)},value:h,pattern:"(.|\\s)*\\S(.|\\s)*"}),"Author:",Object(o.jsx)("input",{className:"form__input",type:"text",onChange:function(e){return m(e.target.value)},value:O,pattern:"(.|\\s)*\\S(.|\\s)*"}),"Price:",Object(o.jsx)("input",{className:"form__input",type:"number",min:0,max:2e3,value:v,onChange:function(e){return y(parseInt(e.target.value))}}),Object(o.jsx)("button",{className:"form__button",onClick:function(){return function(e){return S.apply(this,arguments)}({title:h,author:O,priceInEuro:v})},children:"Bevestigen"}),Object(o.jsx)("button",{className:"form__button",onClick:null!==r?function(){return function(e){return w.apply(this,arguments)}(r)}:console.log("Deze boek bestaat niet."),children:"Bewerken"})]})};var h=function(e){var t=Object(c.useState)(""),n=Object(b.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(""),u=Object(b.a)(s,2),l=u[0],f=u[1],h=e.authenticate;function j(){return(j=Object(p.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(r,l),a(""),f("");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.jsxs)("form",{className:"login__form",onSubmit:function(e){return e.preventDefault()},children:["Username:",Object(o.jsx)("input",{type:"text",className:"login__input",onChange:function(e){return a(e.target.value)},value:r}),"Password:",Object(o.jsx)("input",{type:"password",className:"login__input",onChange:function(e){return f(e.target.value)},value:l}),Object(o.jsx)("button",{className:"login__submit",onClick:function(){return function(){return j.apply(this,arguments)}()},children:"Login"})]})};var j=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),s=Object(b.a)(a,2),u=s[0],j=s[1],d=Object(c.useState)(null),k=Object(b.a)(d,2),O=k[0],m=k[1],g=Object(c.useState)(""),x=Object(b.a)(g,2),v=x[0],y=x[1],S=Object(c.useState)((function(){return localStorage.getItem("user")})),w=Object(b.a)(S,2),C=w[0],N=w[1],E=Object(c.useState)((function(){return localStorage.getItem("csrfToken")})),_=Object(b.a)(E,2),T=_[0],B=_[1];function R(){return X.apply(this,arguments)}function X(){return(X=Object(p.a)(i.a.mark((function e(){var t,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,t={method:"GET"},e.next=5,L("".concat("https://tb-books-backend.herokuapp.com","/books"),t);case 5:if(n=e.sent,console.log(n),!n.ok){e.next=12;break}return e.next=10,n.json();case 10:o=e.sent,r(o);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),y("Connection error.");case 18:j(!1);case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function I(){return(I=Object(p.a)(i.a.mark((function e(t,n){var o,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("username: ".concat(t,"\npassword: ").concat(n)),o={method:"GET",credentials:"include",headers:{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest",authorization:"Basic "+window.btoa("".concat(t,":").concat(n))}},e.next=4,fetch("".concat("https://tb-books-backend.herokuapp.com","/authenticate"),o);case 4:if(c=e.sent,console.log(c.headers.get("X-XSRF-TOKEN")),localStorage.setItem("csrfToken",c.headers.get("X-XSRF-TOKEN")),B(c.headers.get("X-XSRF-TOKEN")||T),!c.ok){e.next=17;break}return e.next=11,c.json();case 11:r=e.sent,console.log(r),localStorage.setItem("user",r.username),N(r.username),e.next=19;break;case 17:y("Failed to login"),console.log(c);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(p.a)(i.a.mark((function e(t,n){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={method:n.method,credentials:"include",headers:T?{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":T}:{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest"},body:n.body},e.next=3,fetch(t,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(p.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST"},e.next=3,L("".concat("https://tb-books-backend.herokuapp.com","/logout"),t);case 3:n=e.sent,N(null),localStorage.clear(),console.log(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=Object(p.a)(i.a.mark((function e(t){var n,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"DELETE"},e.prev=1,e.next=4,L("".concat("https://tb-books-backend.herokuapp.com","/books/").concat(t.id),n);case 4:return o=e.sent,e.next=7,o.json();case 7:c=e.sent,o.ok?(y("Book deleted successfully."),r(c)):y("".concat(c.message)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),y("Connection error.");case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){console.log(T)}),[T]),Object(c.useEffect)((function(){null!==C&&R()}),[C]),Object(o.jsx)("div",{className:"App",children:C?Object(o.jsxs)("div",{className:".book__form",children:[Object(o.jsx)("button",{onClick:function(){return R()},children:"Refresh"}),Object(o.jsx)("button",{className:"logout",onClick:function(){return D.apply(this,arguments)},children:"Logout"}),Object(o.jsx)("br",{}),!!u&&Object(o.jsx)("p",{children:"LOADING DATA"}),Object(o.jsx)("br",{}),C&&Object(o.jsxs)("span",{children:["logged in as ",C]}),Object(o.jsx)("br",{}),Object(o.jsx)("span",{children:v}),n.map((function(e){return Object(o.jsxs)("p",{className:"book",onClick:function(){return m(e)},style:{backgroundColor:"".concat(O===e?"grey":"transparent")},children:["title: ",e.title+" - ","author: ",e.author+" - ","price: ",e.priceInEuro,Object(o.jsx)("button",{onClick:function(){return function(e){return q.apply(this,arguments)}(e)},children:"Delete"})]},e.id)})),Object(o.jsx)(f,{bookToEdit:O,setIsLoading:j,addBook:function(e){return r([].concat(Object(l.a)(n),[e]))},setBooks:r,setMessage:y,fetchWithCsrf:L})]}):Object(o.jsx)(h,{authenticate:function(e,t){return I.apply(this,arguments)}})})};s.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(j,{})}),document.getElementById("root"))},8:function(e,t,n){}},[[18,1,2]]]);
//# sourceMappingURL=main.ba9fc8fa.chunk.js.map
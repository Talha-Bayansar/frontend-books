(this.webpackJsonpbooksclient=this.webpackJsonpbooksclient||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n(1),r=n.n(o),a=n(9),s=n.n(a),u=(n(16),n(2)),i=n.n(u),l=n(10),p=n(4),f=n(3);n(8);var b=function(e){var t=e.addBook,n=e.setIsLoading,r=e.bookToEdit,a=e.setBooks,s=e.setMessage,u=e.fetchWithCsrf,l=Object(o.useState)(""),b=Object(f.a)(l,2),h=b[0],j=b[1],d=Object(o.useState)(""),O=Object(f.a)(d,2),g=O[0],m=O[1],x=Object(o.useState)(0),k=Object(f.a)(x,2),v=k[0],y=k[1];function S(){return(S=Object(p.a)(i.a.mark((function e(c){var o,r,a,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),o={method:"POST",body:JSON.stringify(c)},e.prev=2,e.next=5,u("".concat("http://localhost:8081","/books"),o);case 5:return r=e.sent,e.next=8,r.json();case 8:a=e.sent,r.ok?(console.log("async createBook: received response ".concat(JSON.stringify(a))),t(a),s("Book added successfully."),console.log("createBook: done")):(console.log("async createBook: ERROR: ".concat(r.status," - ").concat(a.error," - ").concat(a.message)),l=a.errors&&a.errors.reduce((function(e,t){return"".concat(e," ").concat(t.defaultMessage," ---")}),"--- "),s(l||a.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0),s("Connection error.");case 16:n(!1);case 17:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function w(){return(w=Object(p.a)(i.a.mark((function e(t){var n,c,o,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PUT",body:JSON.stringify({id:t.id,title:h,author:g,priceInEuro:v})},e.prev=1,e.next=4,u("".concat("http://localhost:8081","/books/").concat(t.id),n);case 4:return c=e.sent,e.next=7,c.json();case 7:o=e.sent,console.log(o),c.ok?(s("Book edited successfully."),console.log("createBook: done"),a(o)):(r=o.errors&&o.errors.reduce((function(e,t){return"".concat(e," ").concat(t.defaultMessage," ---")}),"--- "),s(r||o.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),s("Connection error.");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}return Object(o.useEffect)((function(){r&&(j(r.title),m(r.author),y(r.priceInEuro))}),[r]),Object(c.jsxs)("form",{className:"form",onSubmit:function(e){e.preventDefault()},children:["Title:",Object(c.jsx)("input",{className:"form__input",type:"text",onChange:function(e){return j(e.target.value)},value:h,pattern:"(.|\\s)*\\S(.|\\s)*"}),"Author:",Object(c.jsx)("input",{className:"form__input",type:"text",onChange:function(e){return m(e.target.value)},value:g,pattern:"(.|\\s)*\\S(.|\\s)*"}),"Price:",Object(c.jsx)("input",{className:"form__input",type:"number",min:0,max:2e3,value:v,onChange:function(e){return y(parseInt(e.target.value))}}),Object(c.jsx)("button",{className:"form__button",onClick:function(){return function(e){return S.apply(this,arguments)}({title:h,author:g,priceInEuro:v})},children:"Bevestigen"}),Object(c.jsx)("button",{className:"form__button",onClick:null!==r?function(){return function(e){return w.apply(this,arguments)}(r)}:console.log("Deze boek bestaat niet."),children:"Bewerken"})]})};var h=function(e){var t=Object(o.useState)(""),n=Object(f.a)(t,2),r=n[0],a=n[1],s=Object(o.useState)(""),u=Object(f.a)(s,2),l=u[0],b=u[1],h=e.authenticate;function j(){return(j=Object(p.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(r,l),a(""),b("");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.jsxs)("form",{className:"login__form",onSubmit:function(e){return e.preventDefault()},children:["Username:",Object(c.jsx)("input",{type:"text",className:"login__input",onChange:function(e){return a(e.target.value)},value:r}),"Password:",Object(c.jsx)("input",{type:"password",className:"login__input",onChange:function(e){return b(e.target.value)},value:l}),Object(c.jsx)("button",{className:"login__submit",onClick:function(){return function(){return j.apply(this,arguments)}()},children:"Login"})]})};var j=function(){var e=Object(o.useState)([]),t=Object(f.a)(e,2),n=t[0],r=t[1],a=Object(o.useState)(!1),s=Object(f.a)(a,2),u=s[0],j=s[1],d=Object(o.useState)(null),O=Object(f.a)(d,2),g=O[0],m=O[1],x=Object(o.useState)(""),k=Object(f.a)(x,2),v=k[0],y=k[1],S=Object(o.useState)((function(){return localStorage.getItem("user")})),w=Object(f.a)(S,2),C=w[0],N=w[1],E=Object(o.useState)((function(){return localStorage.getItem("csrfToken")})),_=Object(f.a)(E,2),T=_[0],B=_[1];function R(){return X.apply(this,arguments)}function X(){return(X=Object(p.a)(i.a.mark((function e(){var t,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,t={method:"GET"},e.next=5,L("".concat("http://localhost:8081","/books"),t);case 5:if(n=e.sent,console.log(n),!n.ok){e.next=12;break}return e.next=10,n.json();case 10:c=e.sent,r(c);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),y("Connection error.");case 18:j(!1);case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function I(){return(I=Object(p.a)(i.a.mark((function e(t,n){var c,o,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("username: ".concat(t,"\npassword: ").concat(n)),c={method:"GET",credentials:"include",headers:{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest",authorization:"Basic "+window.btoa("".concat(t,":").concat(n))}},e.next=4,fetch("".concat("http://localhost:8081","/authenticate"),c);case 4:if(o=e.sent,console.log(o.headers.get("X-XSRF-TOKEN")),localStorage.setItem("csrfToken",o.headers.get("X-XSRF-TOKEN")),B(o.headers.get("X-XSRF-TOKEN")||T),!o.ok){e.next=17;break}return e.next=11,o.json();case 11:r=e.sent,console.log(r),localStorage.setItem("user",r.username),N(r.username),e.next=19;break;case 17:y("Failed to login"),console.log(o);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(p.a)(i.a.mark((function e(t,n){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={method:n.method,credentials:"include",headers:T?{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":T}:{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest"},body:n.body},e.next=3,fetch(t,c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(p.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST"},e.next=3,L("".concat("http://localhost:8081","/logout"),t);case 3:n=e.sent,N(null),localStorage.clear(),console.log(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=Object(p.a)(i.a.mark((function e(t){var n,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"DELETE"},e.prev=1,e.next=4,L("".concat("http://localhost:8081","/books/").concat(t.id),n);case 4:return c=e.sent,e.next=7,c.json();case 7:o=e.sent,c.ok?(y("Book deleted successfully."),r(o)):y("".concat(o.message)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),y("Connection error.");case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}return Object(o.useEffect)((function(){console.log(T)}),[T]),Object(o.useEffect)((function(){null!==C&&R()}),[C]),Object(c.jsx)("div",{className:"App",children:C?Object(c.jsxs)("div",{className:".book__form",children:[Object(c.jsx)("button",{onClick:function(){return R()},children:"Refresh"}),Object(c.jsx)("button",{className:"logout",onClick:function(){return D.apply(this,arguments)},children:"Logout"}),Object(c.jsx)("br",{}),!!u&&Object(c.jsx)("p",{children:"LOADING DATA"}),Object(c.jsx)("br",{}),C&&Object(c.jsxs)("span",{children:["logged in as ",C]}),Object(c.jsx)("br",{}),Object(c.jsx)("span",{children:v}),n.map((function(e){return Object(c.jsxs)("p",{className:"book",onClick:function(){return m(e)},style:{backgroundColor:"".concat(g===e?"grey":"transparent")},children:["title: ",e.title+" - ","author: ",e.author+" - ","price: ",e.priceInEuro,Object(c.jsx)("button",{onClick:function(){return function(e){return q.apply(this,arguments)}(e)},children:"Delete"})]},e.id)})),Object(c.jsx)(b,{bookToEdit:g,setIsLoading:j,addBook:function(e){return r([].concat(Object(l.a)(n),[e]))},setBooks:r,setMessage:y,fetchWithCsrf:L})]}):Object(c.jsx)(h,{authenticate:function(e,t){return I.apply(this,arguments)}})})};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(j,{})}),document.getElementById("root"))},8:function(e,t,n){}},[[18,1,2]]]);
//# sourceMappingURL=main.33654396.chunk.js.map